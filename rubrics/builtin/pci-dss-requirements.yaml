# PCI DSS v4.0 Requirements Rubric Pack
# GuardSpine Governance Evidence Requirements
#
# Based on PCI DSS v4.0 (March 2022)
# https://www.pcisecuritystandards.org/

name: "PCI DSS v4.0 Requirements"
version: "1.0.0"
description: "Rubric pack for PCI DSS compliance evidence generation"

rules:
  # Requirement 1: Network Security
  - id: "PCI-1.2.1"
    category: "REQ1-NetworkSecurity"
    name: "Firewall Rules"
    description: "Configuration standards for network security controls"
    severity: "critical"
    patterns:
      - "firewall|iptables|nsg|security.*group|acl"

  - id: "PCI-1.3.1"
    category: "REQ1-NetworkSecurity"
    name: "Network Segmentation"
    description: "Restrict inbound traffic to CDE"
    severity: "critical"
    patterns:
      - "cde|cardholder.*environment|pci.*zone|dmz"

  # Requirement 2: Secure Configurations
  - id: "PCI-2.2.1"
    category: "REQ2-SecureConfig"
    name: "Configuration Standards"
    description: "Configuration standards for all system components"
    severity: "high"
    patterns:
      - "default.*password|vendor.*default|sample.*config"

  # Requirement 3: Protect Stored Data
  - id: "PCI-3.3.1"
    category: "REQ3-StoredData"
    name: "PAN Display Masking"
    description: "PAN is masked when displayed"
    severity: "critical"
    patterns:
      - "pan|card.*number|credit.*card|debit.*card"
      - "display.*pan|show.*card|render.*payment"

  - id: "PCI-3.5.1"
    category: "REQ3-StoredData"
    name: "PAN Encryption"
    description: "PAN is rendered unreadable anywhere stored"
    severity: "critical"
    patterns:
      - "encrypt.*pan|store.*card|persist.*payment"
      - "card.*column|pan.*field|payment.*table"

  - id: "PCI-3.6.1"
    category: "REQ3-StoredData"
    name: "Key Management"
    description: "Cryptographic keys used to protect stored account data"
    severity: "critical"
    patterns:
      - "encryption.*key|kek|dek|key.*rotation"

  # Requirement 4: Protect Data in Transit
  - id: "PCI-4.2.1"
    category: "REQ4-DataInTransit"
    name: "Strong Cryptography in Transit"
    description: "PAN is protected with strong cryptography during transmission"
    severity: "critical"
    patterns:
      - "tls|ssl|https|transport.*security"
      - "cipher.*suite|protocol.*version|certificate"

  # Requirement 6: Secure Development
  - id: "PCI-6.2.1"
    category: "REQ6-SecureDev"
    name: "Secure Development Lifecycle"
    description: "Bespoke and custom software is developed securely"
    severity: "high"
    patterns:
      - "payment|checkout|transaction|card.*processing"

  - id: "PCI-6.3.1"
    category: "REQ6-SecureDev"
    name: "Vulnerability Management"
    description: "Security vulnerabilities are identified and addressed"
    severity: "critical"
    patterns:
      - "CVE-|vulnerability|security.*patch|critical.*fix"

  - id: "PCI-6.5.1"
    category: "REQ6-SecureDev"
    name: "Injection Flaws"
    description: "Prevent injection attacks"
    severity: "critical"
    patterns:
      - "sql.*query|exec.*command|\\beval\\s*\\(|\\bsystem\\s*\\("

  # Requirement 7: Access Control
  - id: "PCI-7.2.1"
    category: "REQ7-AccessControl"
    name: "Access Control Model"
    description: "Access control model is defined and includes coverage"
    severity: "critical"
    patterns:
      - "access.*control|rbac|permission|privilege"

  # Requirement 8: Authentication
  - id: "PCI-8.3.1"
    category: "REQ8-Authentication"
    name: "Strong Authentication"
    description: "Strong authentication for users and administrators"
    severity: "critical"
    patterns:
      - "authentication|password|mfa|multi.*factor"

  - id: "PCI-8.6.1"
    category: "REQ8-Authentication"
    name: "Application Account Management"
    description: "Use of application and system accounts"
    severity: "high"
    patterns:
      - "service.*account|api.*key|application.*credential"

  # Requirement 10: Logging and Monitoring
  - id: "PCI-10.2.1"
    category: "REQ10-Logging"
    name: "Audit Logs Enabled"
    description: "Audit logs are enabled and active"
    severity: "critical"
    patterns:
      - "audit.*log|security.*event|access.*log"

  - id: "PCI-10.4.1"
    category: "REQ10-Logging"
    name: "Log Review"
    description: "Audit logs are reviewed"
    severity: "high"
    patterns:
      - "siem|log.*analysis|alert.*rule|detection"

  # Requirement 11: Security Testing
  - id: "PCI-11.3.1"
    category: "REQ11-SecurityTesting"
    name: "Vulnerability Scanning"
    description: "Internal vulnerability scans are performed"
    severity: "high"
    patterns:
      - "vulnerability.*scan|security.*scan|pentest"
