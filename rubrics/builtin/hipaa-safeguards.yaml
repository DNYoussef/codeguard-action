# HIPAA Security Rule Safeguards Rubric Pack
# GuardSpine Governance Evidence Requirements
#
# Based on 45 CFR Parts 160 and 164
# https://www.hhs.gov/hipaa/for-professionals/security/index.html

name: "HIPAA Security Safeguards"
version: "1.0.0"
description: "Rubric pack for HIPAA compliance evidence generation"

rules:
  # Administrative Safeguards (164.308)
  - id: "HIPAA-308.a.1"
    category: "ADMIN-SecurityMgmt"
    name: "Security Management Process"
    description: "Risk analysis and management"
    severity: "critical"
    patterns:
      - "\\bphi\\b|protected.*health|patient.*data|medical.*record"

  - id: "HIPAA-308.a.3"
    category: "ADMIN-WorkforceSecurity"
    name: "Workforce Security"
    description: "Authorization and supervision"
    severity: "high"
    patterns:
      - "user.*access|role.*phi|permission.*patient"

  - id: "HIPAA-308.a.4"
    category: "ADMIN-AccessMgmt"
    name: "Information Access Management"
    description: "Access authorization policies"
    severity: "critical"
    patterns:
      - "grant.*access|authorize.*phi|clearance"

  - id: "HIPAA-308.a.5"
    category: "ADMIN-Training"
    name: "Security Awareness Training"
    description: "Training and awareness program"
    severity: "medium"
    patterns:
      - "training|awareness|security.*education"

  - id: "HIPAA-308.a.6"
    category: "ADMIN-Incident"
    name: "Security Incident Procedures"
    description: "Response and reporting"
    severity: "critical"
    patterns:
      - "breach|incident|unauthorized.*access|phi.*exposure"

  - id: "HIPAA-308.a.7"
    category: "ADMIN-Contingency"
    name: "Contingency Plan"
    description: "Data backup and disaster recovery"
    severity: "high"
    patterns:
      - "backup|disaster.*recovery|contingency|failover"

  # Physical Safeguards (164.310)
  - id: "HIPAA-310.a.1"
    category: "PHYS-FacilityAccess"
    name: "Facility Access Controls"
    description: "Physical access policies"
    severity: "high"
    patterns:
      - "datacenter|server.*room|physical.*access|badge"

  - id: "HIPAA-310.d.1"
    category: "PHYS-DeviceMedia"
    name: "Device and Media Controls"
    description: "Hardware and media management"
    severity: "critical"
    patterns:
      - "disk.*disposal|media.*sanitization|device.*inventory"

  # Technical Safeguards (164.312)
  - id: "HIPAA-312.a.1"
    category: "TECH-AccessControl"
    name: "Access Control"
    description: "Unique user identification and access controls"
    severity: "critical"
    patterns:
      - "(?:phi|patient|health|medical|ephi).*(?:authentication|login|session|access)"
      - "(?:authentication|login|session).*(?:phi|patient|health|medical|ephi)"

  - id: "HIPAA-312.b"
    category: "TECH-AuditControls"
    name: "Audit Controls"
    description: "Hardware, software, and procedural mechanisms"
    severity: "critical"
    patterns:
      - "(?:phi|patient|health|medical|ephi).*(?:audit.*log|access.*log|audit.*trail)"
      - "(?:audit.*log|access.*log|audit.*trail).*(?:phi|patient|health|medical|ephi)"

  - id: "HIPAA-312.c.1"
    category: "TECH-Integrity"
    name: "Integrity Controls"
    description: "ePHI integrity mechanisms"
    severity: "critical"
    patterns:
      - "(?:phi|patient|health|medical|ephi).*(?:checksum|hash|integrity|signature|tamper)"
      - "(?:checksum|hash|integrity|signature|tamper).*(?:phi|patient|health|medical|ephi)"

  - id: "HIPAA-312.d"
    category: "TECH-Authentication"
    name: "Person or Entity Authentication"
    description: "Verify person or entity identity"
    severity: "critical"
    patterns:
      - "\\bmfa\\b|multi.*factor|biometric|x509.*certificate|auth.*token"

  - id: "HIPAA-312.e.1"
    category: "TECH-Transmission"
    name: "Transmission Security"
    description: "Encryption for ePHI in transit"
    severity: "critical"
    patterns:
      - "tls|ssl|https|encrypt.*transit|vpn"
      - "certificate|cipher|protocol.*version"
